import &StandardImport, &CaffeineEight

->
  @rule
    valueList: :simpleValueList, :valueListBlock

  @rule
    valueListBlock:         Extensions.IndentBlocks.getPropsToSubparseBlock rule: "valueListBlockSubParse"
    valueListBlockSubParse: "end* listItemStatement+"

  @rule
    simpleValueList:
      "element:listItemExpression optionalComma simpleValueList"
      "element:listItemExpression _? ',' _? valueListBlock"
      "element:listItemExpression"

    simpleValueListWithoutImplicitObjects:
      ""
        !implicitObjectStart
        simpleValueListWithoutImplicitObjectOptions

    simpleValueListWithoutImplicitObjectOptions:
      "element:listItemExpression optionalComma simpleValueListWithoutImplicitObjects"
      "element:listItemExpression _? ',' _? valueListBlock"
      "element:listItemExpression"

  @rule
    listItemStatement:
      {}
        pattern: "statementWithoutEnd newLineStatementExtension* ellipsis end"
        stnFactory: :ArraySpreadElementStn
      {}
        pattern: "lineStartStatementWithoutEnd newLineStatementExtension* end"

    listItemExpression:
      {}
        pattern: "expression ellipsis"
        stnFactory: :ArraySpreadElementStn
      {}
        pattern: "expression"
